name: Kali-Style GUI (Tailscale)

on: workflow_dispatch

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Update & Install Desktop (XFCE)
        run: |
          sudo apt update
          # XFCE ডেস্কটপ এনভায়রনমেন্ট এবং XRDP ইনস্টল করা হচ্ছে
          sudo apt install -y xfce4 xfce4-goodies xrdp
          sudo systemctl enable xrdp
          sudo systemctl start xrdp
          # XRDP কে XFCE ব্যবহার করতে বলা হচ্ছে
          echo "xfce4-session" > ~/.xsession
          
      - name: Install Hacking Tools (Making it like Kali)
        run: |
          # কালির মেইন টুলসগুলো নামিয়ে দিচ্ছি
          sudo apt install -y nmap sqlmap nikto git python3-pip net-tools neofetch
          # তুই চাইলে এখানে আরও টুলস যোগ করতে পারিস
          
      - name: Create User (User: kali / Pass: kali)
        run: |
          # নতুন ইউজার তৈরি করা হচ্ছে
          sudo useradd -m -s /bin/bash kali
          # পাসওয়ার্ড সেট করা হচ্ছে: kali
          echo "kali:kali" | sudo chpasswd
          sudo adduser kali sudo
          
      - name: Setup Tailscale
        env:
          TAILSCALE_AUTHKEY: ${{ secrets.TAILSCALE_AUTHKEY }}
        run: |
          # Tailscale ইনস্টল এবং চালু করা
          curl -fsSL https://tailscale.com/install.sh | sh
          sudo tailscale up --authkey $TAILSCALE_AUTHKEY --hostname "github-kali-linux" --accept-routes
          
      - name: Show Info & Keep Alive
        run: |
          echo "=========================================="
          echo "✅ Machine is Running!"
          echo "Username: kali"
          echo "Password: kali"
          echo "Go to Tailscale Dashboard to get the IP"
          echo "=========================================="
          # ৬ ঘন্টা চালু রাখার লুপ
          sleep 21600
          
